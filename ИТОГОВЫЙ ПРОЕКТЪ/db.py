import sqlite3
from config import DATABASE

def init_db():
  
    conn = sqlite3.connect(DATABASE)
    cursor = conn.cursor()
    
  
    cursor.execute('DROP TABLE IF EXISTS countries')
    
   
    cursor.execute('''
    CREATE TABLE countries (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT UNIQUE NOT NULL,
        english_name TEXT UNIQUE NOT NULL,
        region TEXT NOT NULL,
        capital TEXT,
        population INTEGER,
        area REAL,
        density REAL,
        percentage REAL,
        borders TEXT
    )
    ''')
    
    conn.commit()
    return conn

def add_country(conn, name, english_name, region, capital, population, area, density, percentage, borders):

    cursor = conn.cursor()
    try:
        cursor.execute('''
        INSERT INTO countries (name, english_name, region, capital, population, area, density, percentage, borders)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
        ''', (name, english_name, region, capital, population, area, density, percentage, borders))
        return True
    except sqlite3.IntegrityError as e:
        print(f"Ошибка при добавлении {name}: {e}")
        return False

def fill_database():
 
    print("Создаю базу данных...")
    conn = init_db()
    

    countries_data = [
    
        ("Австрия", "Austria", "Западная Европа", "Вена", 8902600, 83871, 106.1, 1.13, "Германия, Чехия, Словакия, Венгрия, Словения, Италия, Швейцария, Лихтенштейн"),
        ("Бельгия", "Belgium", "Западная Европа", "Брюссель", 11524454, 30528, 377.5, 1.47, "Франция, Германия, Нидерланды, Люксембург"),
        ("Германия", "Germany", "Западная Европа", "Берлин", 83166711, 357022, 233.0, 10.57, "Дания, Польша, Чехия, Австрия, Швейцария, Франция, Люксембург, Бельгия, Нидерланды"),
        ("Франция", "France", "Западная Европа", "Париж", 67064000, 551695, 121.6, 8.52, "Бельгия, Люксембург, Германия, Швейцария, Италия, Испания, Андорра, Монако"),
        ("Нидерланды", "Netherlands", "Западная Европа", "Амстердам", 17441139, 41543, 420.0, 2.22, "Германия, Бельгия"),
        ("Швейцария", "Switzerland", "Западная Европа", "Берн", 8615551, 41284, 209.0, 1.09, "Германия, Франция, Италия, Австрия, Лихтенштейн"),
        ("Люксембург", "Luxembourg", "Западная Европа", "Люксембург", 632275, 2586, 244.5, 0.08, "Германия, Франция, Бельгия"),
        ("Великобритания", "United_Kingdom", "Западная Европа", "Лондон", 67215293, 242495, 277.0, 8.54, "Ирландия"),
        ("Ирландия", "Ireland", "Западная Европа", "Дублин", 4921500, 70273, 70.0, 0.63, "Великобритания"),
        

        ("Беларусь", "Belarus", "Восточная Европа", "Минск", 9413446, 207595, 45.4, 1.19, "Россия, Украина, Польша, Литва, Латвия"),
        ("Польша", "Poland", "Восточная Европа", "Варшава", 37950802, 312696, 121.4, 4.82, "Германия, Чехия, Словакия, Украина, Беларусь, Литва, Россия"),
        ("Россия", "Russia", "Восточная Европа", "Москва", 146171015, 17125191, 8.5, 18.57, "Норвегия, Финляндия, Эстония, Латвия, Литва, Польша, Беларусь, Украина, Грузия, Азербайджан, Казахстан"),
        ("Украина", "Ukraine", "Восточная Европа", "Киев", 41588354, 603628, 68.9, 5.28, "Россия, Беларусь, Польша, Словакия, Венгрия, Румыния, Молдова"),
        ("Чехия", "Czech_Republic", "Восточная Европа", "Прага", 10698896, 78867, 135.6, 1.36, "Германия, Польша, Словакия, Австрия"),
        ("Словакия", "Slovakia", "Восточная Европа", "Братислава", 5456362, 49035, 111.3, 0.69, "Польша, Украина, Венгрия, Австрия, Чехия"),
        ("Венгрия", "Hungary", "Восточная Европа", "Будапешт", 9769526, 93030, 105.0, 1.24, "Словакия, Украина, Румыния, Сербия, Хорватия, Словения, Австрия"),
        ("Румыния", "Romania", "Восточная Европа", "Бухарест", 19401658, 238397, 81.4, 2.46, "Украина, Молдова, Венгрия, Сербия, Болгария"),
        ("Болгария", "Bulgaria", "Восточная Европа", "София", 6951482, 110879, 62.7, 0.88, "Румыния, Сербия, Северная Македония, Греция, Турция"),
        

        ("Швеция", "Sweden", "Северная Европа", "Стокгольм", 10367232, 450295, 23.0, 1.32, "Норвегия, Финляндия"),
        ("Норвегия", "Norway", "Северная Европа", "Осло", 5379475, 385207, 14.0, 0.68, "Швеция, Финляндия, Россия"),
        ("Финляндия", "Finland", "Северная Европа", "Хельсинки", 5526613, 338424, 16.3, 0.70, "Швеция, Норвегия, Россия"),
        ("Дания", "Denmark", "Северная Европа", "Копенгаген", 5824857, 43094, 135.1, 0.74, "Германия"),
        ("Исландия", "Iceland", "Северная Европа", "Рейкьявик", 366463, 103000, 3.6, 0.05, ""),
        ("Латвия", "Latvia", "Северная Европа", "Рига", 1906765, 64589, 29.5, 0.24, "Эстония, Россия, Беларусь, Литва"),
        ("Литва", "Lithuania", "Северная Европа", "Вильнюс", 2794191, 65300, 42.8, 0.35, "Латвия, Беларусь, Польша, Россия"),
        ("Эстония", "Estonia", "Северная Европа", "Таллин", 1328976, 45227, 29.4, 0.17, "Россия, Латвия"),
       
        ("Италия", "Italy", "Южная Европа", "Рим", 60317116, 301340, 200.2, 7.66, "Франция, Швейцария, Австрия, Словения"),
        ("Испания", "Spain", "Южная Европа", "Мадрид", 47329981, 505990, 93.5, 6.01, "Португалия, Франция, Андорра, Марокко"),
        ("Греция", "Greece", "Южная Европа", "Афины", 10724599, 131957, 81.3, 1.36, "Албания, Северная Македония, Болгария, Турция"),
        ("Португалия", "Portugal", "Южная Европа", "Лиссабон", 10276617, 92212, 111.5, 1.31, "Испания"),
        ("Сербия", "Serbia", "Южная Европа", "Белград", 6963764, 77474, 89.9, 0.88, "Венгрия, Румыния, Болгария, Северная Македония, Черногория, Босния и Герцеговина, Хорватия"),
        ("Хорватия", "Croatia", "Южная Европа", "Загреб", 4087843, 56594, 72.2, 0.52, "Словения, Венгрия, Сербия, Босния и Герцеговина, Черногория"),
        ("Словения", "Slovenia", "Южная Европа", "Любляна", 2100126, 20273, 103.6, 0.27, "Италия, Австрия, Венгрия, Хорватия"),
        ("Черногория", "Montenegro", "Южная Европа", "Подгорица", 621306, 13812, 45.0, 0.08, "Хорватия, Босния и Герцеговина, Сербия, Албания"),
        ("Албания", "Albania", "Южная Европа", "Тирана", 2873457, 28748, 100.0, 0.37, "Черногория, Косово, Северная Македония, Греция"),
        ("Северная Македония", "North_Macedonia", "Южная Европа", "Скопье", 2077132, 25713, 80.8, 0.26, "Сербия, Болгария, Греция, Албания"),
    ]
    
    print("Заполняю базу данных странами...")
    added_count = 0
    total_count = len(countries_data)
    
    for country in countries_data:
        if add_country(conn, *country):
            added_count += 1
            print(f"✓ Добавлена: {country[0]}")
        else:
            print(f"✗ Ошибка: {country[0]}")
    
    conn.commit()
    conn.close()
    
    print(f"\nБаза данных успешно создана!")
    print(f"Добавлено стран: {added_count} из {total_count}")
    
  
    conn = sqlite3.connect(DATABASE)
    cursor = conn.cursor()
    cursor.execute("SELECT COUNT(*) FROM countries")
    count = cursor.fetchone()[0]
    conn.close()
    
    print(f"В базе данных: {count} стран")
    return count

if __name__ == "__main__":

    fill_database()
